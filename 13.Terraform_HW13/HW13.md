## HW13
Сделать с помощью Terraform:
1.	Создать EC2 и security group, при этом новый сервер должен содержать созданную security group.
2.	Создать новую VPC и в ней создать EC2 сервер. В аутпут вынести id созданного сервера.
3.	Через data найти любую созданную SG.
4.	Не забыть всё удалить и использовать t3.micro.



```bash
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ terraform --version
Terraform v1.9.8
on linux_amd64

Your version of Terraform is out of date! The latest version
is 1.10.2. You can update by downloading from https://www.terraform.io/downloads.html
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ export PATH=$PATH:/usr/local/bin
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$

ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ source ~/.bashrc
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ ls -la
total 20
drwxrwxr-x 2 ivcpaladin ivcpaladin 4096 Dec 16 13:29 .
drwxrwxr-x 4 ivcpaladin ivcpaladin 4096 Dec 16 12:54 ..
-rw-rw-r-- 1 ivcpaladin ivcpaladin 4922 Dec 16 13:28 LICENSE.txt
-rw-rw-r-- 1 ivcpaladin ivcpaladin 1482 Dec 16 12:55 main.tf
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ terraform init
Initializing the backend...
Initializing provider plugins...
- Finding latest version of hashicorp/aws...
╷
│ Error: Invalid provider registry host
│
│ The host "registry.terraform.io" given in provider source address "registry.terraform.io/hashicorp/aws" does not offer a Terraform provider registry.
╵
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ terraform apply
╷
│ Error: Inconsistent dependency lock file
│
│ The following dependency selections recorded in the lock file are inconsistent with the current configuration:
│   - provider registry.terraform.io/hashicorp/aws: required by this configuration but no version is selected
│
│ To make the initial dependency selections that will initialize the dependency lock file, run:
│   terraform init
╵
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ ~/.terraformrc
-bash: /home/ivcpaladin/.terraformrc: No such file or directory
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ curl -I https://terraform-mirror.yandexcloud.net/
HTTP/2 404
date: Mon, 16 Dec 2024 13:35:13 GMT
content-type: text/plain
vary: Accept-Encoding
access-control-allow-origin: *
x-content-type-options: nosniff
x-request-id: f1b4463d-4f16-46bc-bf61-c9440feb3a17
x-serverless-gateway-id: d5djbr5c7hovfs4fup0p
x-server-trace-id: c0265e7752ea0009:f57d3b71beac38de:c0265e7752ea0009:1
server: Yandex-API-Gateway/1.0
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ nano ~/.terraformrc
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ curl -I https://mirror.timeweb.ru/terraform/
HTTP/1.1 404 Not Found
Server: nginx
Date: Mon, 16 Dec 2024 13:36:31 GMT
Content-Type: text/html
Content-Length: 146
Connection: keep-alive
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ nano ~/.terraformrc
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ curl -I https://nm.tf.org.ru/
HTTP/2 404
server: nginx
date: Mon, 16 Dec 2024 13:38:09 GMT
content-type: text/html; charset=utf-8
content-length: 225
x-amz-request-id: 94db7041d2958390
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ curl -I https://registry.comcloud.xyz/
HTTP/2 200
server: nginx
date: Mon, 16 Dec 2024 13:39:02 GMT
content-type: text/html; charset=utf-8
content-length: 10441
vary: Accept-Encoding
vary: Cookie
set-cookie: session=eyJfZnJlc2giOmZhbHNlLCJsb2NhbGUiOiJlbiIsInBhZ2VfaGlzdG9yeSI6WyJodHRwczovLzEyNy4wLjAuMTo4MDgxLyJdfQ.Z2Atbg.hSyVzZKBBea7Iq-TyGHLFpTYIZw; HttpOnly; Path=/
strict-transport-security: max-age=31536000; includeSubDomains
strict-transport-security: max-age=31536000; includeSubDomains
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ nano ~/.terraformrc
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ terraform init -upgrade
Initializing the backend...
Initializing provider plugins...
- Finding latest version of hashicorp/aws...
- Installing hashicorp/aws v5.81.0...
- Installed hashicorp/aws v5.81.0 (verified checksum)
Terraform has created a lock file .terraform.lock.hcl to record the provider
selections it made above. Include this file in your version control repository
so that Terraform can guarantee to make the same selections by default when
you run "terraform init" in the future.
│ Warning: Incomplete lock file information for providers
│
│ Due to your customized provider installation methods, Terraform was forced to calculate lock file checksums locally for the following providers:
│   - hashicorp/aws
│
│ The current .terraform.lock.hcl file only includes checksums for linux_amd64, so Terraform running on another platform will fail to install these providers.
│
│ To calculate additional checksums for another platform, run:
│   terraform providers lock -platform=linux_amd64
│ (where linux_amd64 is the platform to generate)
╵
Terraform has been successfully initialized!

You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ terraform plan

Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # aws_instance.custom_instance will be created
  + resource "aws_instance" "custom_instance" {
      + ami                                  = "ami-0c55b159cbfafe1f0"
      + arn                                  = (known after apply)
      + associate_public_ip_address          = (known after apply)
      + availability_zone                    = (known after apply)
      + cpu_core_count                       = (known after apply)
      + cpu_threads_per_core                 = (known after apply)
      + disable_api_stop                     = (known after apply)
      + disable_api_termination              = (known after apply)
      + ebs_optimized                        = (known after apply)
      + enable_primary_ipv6                  = (known after apply)
      + get_password_data                    = false
      + host_id                              = (known after apply)
      + host_resource_group_arn              = (known after apply)
      + iam_instance_profile                 = (known after apply)
      + id                                   = (known after apply)
      + instance_initiated_shutdown_behavior = (known after apply)
      + instance_lifecycle                   = (known after apply)
      + instance_state                       = (known after apply)
      + instance_type                        = "t3.micro"
      + ipv6_address_count                   = (known after apply)
      + ipv6_addresses                       = (known after apply)
      + key_name                             = (known after apply)
      + monitoring                           = (known after apply)
      + outpost_arn                          = (known after apply)
      + password_data                        = (known after apply)
      + placement_group                      = (known after apply)
      + placement_partition_number           = (known after apply)
      + primary_network_interface_id         = (known after apply)
      + private_dns                          = (known after apply)
      + private_ip                           = (known after apply)
      + public_dns                           = (known after apply)
      + public_ip                            = (known after apply)
      + secondary_private_ips                = (known after apply)
      + security_groups                      = (known after apply)
      + source_dest_check                    = true
      + spot_instance_request_id             = (known after apply)
      + subnet_id                            = (known after apply)
      + tags                                 = {
          + "Name" = "custom_instance"
        }
      + tags_all                             = {
          + "Name" = "custom_instance"
        }
      + tenancy                              = (known after apply)
      + user_data                            = (known after apply)
      + user_data_base64                     = (known after apply)
      + user_data_replace_on_change          = false
      + vpc_security_group_ids               = (known after apply)

      + capacity_reservation_specification (known after apply)

      + cpu_options (known after apply)

      + ebs_block_device (known after apply)

      + enclave_options (known after apply)

      + ephemeral_block_device (known after apply)

      + instance_market_options (known after apply)

      + maintenance_options (known after apply)

      + metadata_options (known after apply)

      + network_interface (known after apply)

      + private_dns_name_options (known after apply)

      + root_block_device (known after apply)
    }

  # aws_security_group.custom_sg will be created
  + resource "aws_security_group" "custom_sg" {
      + arn                    = (known after apply)
      + description            = "Custom security group"
      + egress                 = [
          + {
              + cidr_blocks      = [
                  + "0.0.0.0/0",
                ]
              + from_port        = 0
              + ipv6_cidr_blocks = []
              + prefix_list_ids  = []
              + protocol         = "-1"
              + security_groups  = []
              + self             = false
              + to_port          = 0
                # (1 unchanged attribute hidden)
            },
        ]
      + id                     = (known after apply)
      + ingress                = [
          + {
              + cidr_blocks      = [
                  + "0.0.0.0/0",
                ]
              + from_port        = 22
              + ipv6_cidr_blocks = []
              + prefix_list_ids  = []
              + protocol         = "tcp"
              + security_groups  = []
              + self             = false
              + to_port          = 22
                # (1 unchanged attribute hidden)
            },
        ]
      + name                   = "custom_sg"
      + name_prefix            = (known after apply)
      + owner_id               = (known after apply)
      + revoke_rules_on_delete = false
      + tags                   = {
          + "Name" = "custom_sg"
        }
      + tags_all               = {
          + "Name" = "custom_sg"
        }
      + vpc_id                 = (known after apply)
    }

  # aws_subnet.custom_subnet will be created
  + resource "aws_subnet" "custom_subnet" {
      + arn                                            = (known after apply)
      + assign_ipv6_address_on_creation                = false
      + availability_zone                              = "us-east-1a"
      + availability_zone_id                           = (known after apply)
      + cidr_block                                     = "10.0.1.0/24"
      + enable_dns64                                   = false
      + enable_resource_name_dns_a_record_on_launch    = false
      + enable_resource_name_dns_aaaa_record_on_launch = false
      + id                                             = (known after apply)
      + ipv6_cidr_block_association_id                 = (known after apply)
      + ipv6_native                                    = false
      + map_public_ip_on_launch                        = false
      + owner_id                                       = (known after apply)
      + private_dns_hostname_type_on_launch            = (known after apply)
      + tags                                           = {
          + "Name" = "custom_subnet"
        }
      + tags_all                                       = {
          + "Name" = "custom_subnet"
        }
      + vpc_id                                         = (known after apply)
    }

  # aws_vpc.custom_vpc will be created
  + resource "aws_vpc" "custom_vpc" {
      + arn                                  = (known after apply)
      + cidr_block                           = "10.0.0.0/16"
      + default_network_acl_id               = (known after apply)
      + default_route_table_id               = (known after apply)
      + default_security_group_id            = (known after apply)
      + dhcp_options_id                      = (known after apply)
      + enable_dns_hostnames                 = (known after apply)
      + enable_dns_support                   = true
      + enable_network_address_usage_metrics = (known after apply)
      + id                                   = (known after apply)
      + instance_tenancy                     = "default"
      + ipv6_association_id                  = (known after apply)
      + ipv6_cidr_block                      = (known after apply)
      + ipv6_cidr_block_network_border_group = (known after apply)
      + main_route_table_id                  = (known after apply)
      + owner_id                             = (known after apply)
      + tags                                 = {
          + "Name" = "custom_vpc"
        }
      + tags_all                             = {
          + "Name" = "custom_vpc"
        }
    }

Plan: 4 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + instance_id = (known after apply)

──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

Note: You didn't use the -out option to save this plan, so Terraform can't guarantee to take exactly these actions if you run "terraform apply" now.
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ terraform plan -out=tfplan
Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # aws_instance.custom_instance will be created
  + resource "aws_instance" "custom_instance" {
      + ami                                  = "ami-0c55b159cbfafe1f0"
      + arn                                  = (known after apply)
      + associate_public_ip_address          = (known after apply)
      + availability_zone                    = (known after apply)
      + cpu_core_count                       = (known after apply)
      + cpu_threads_per_core                 = (known after apply)
      + disable_api_stop                     = (known after apply)
      + disable_api_termination              = (known after apply)
      + ebs_optimized                        = (known after apply)
      + enable_primary_ipv6                  = (known after apply)
      + get_password_data                    = false
      + host_id                              = (known after apply)
      + host_resource_group_arn              = (known after apply)
      + iam_instance_profile                 = (known after apply)
      + id                                   = (known after apply)
      + instance_initiated_shutdown_behavior = (known after apply)
      + instance_lifecycle                   = (known after apply)
      + instance_state                       = (known after apply)
      + instance_type                        = "t3.micro"
      + ipv6_address_count                   = (known after apply)
      + ipv6_addresses                       = (known after apply)
      + key_name                             = (known after apply)
      + monitoring                           = (known after apply)
      + outpost_arn                          = (known after apply)
      + password_data                        = (known after apply)
      + placement_group                      = (known after apply)
      + placement_partition_number           = (known after apply)
      + primary_network_interface_id         = (known after apply)
      + private_dns                          = (known after apply)
      + private_ip                           = (known after apply)
      + public_dns                           = (known after apply)
      + public_ip                            = (known after apply)
      + secondary_private_ips                = (known after apply)
      + security_groups                      = (known after apply)
      + source_dest_check                    = true
      + spot_instance_request_id             = (known after apply)
      + subnet_id                            = (known after apply)
      + tags                                 = {
          + "Name" = "custom_instance"
        }
      + tags_all                             = {
          + "Name" = "custom_instance"
        }
      + tenancy                              = (known after apply)
      + user_data                            = (known after apply)
      + user_data_base64                     = (known after apply)
      + user_data_replace_on_change          = false
      + vpc_security_group_ids               = (known after apply)

      + capacity_reservation_specification (known after apply)

      + cpu_options (known after apply)

      + ebs_block_device (known after apply)

      + enclave_options (known after apply)

      + ephemeral_block_device (known after apply)

      + instance_market_options (known after apply)

      + maintenance_options (known after apply)

      + metadata_options (known after apply)

      + network_interface (known after apply)

      + private_dns_name_options (known after apply)

      + root_block_device (known after apply)
    }

  # aws_security_group.custom_sg will be created
  + resource "aws_security_group" "custom_sg" {
      + arn                    = (known after apply)
      + description            = "Custom security group"
      + egress                 = [
          + {
              + cidr_blocks      = [
                  + "0.0.0.0/0",
                ]
              + from_port        = 0
              + ipv6_cidr_blocks = []
              + prefix_list_ids  = []
              + protocol         = "-1"
              + security_groups  = []
              + self             = false
              + to_port          = 0
                # (1 unchanged attribute hidden)
            },
        ]
      + id                     = (known after apply)
      + ingress                = [
          + {
              + cidr_blocks      = [
                  + "0.0.0.0/0",
                ]
              + from_port        = 22
              + ipv6_cidr_blocks = []
              + prefix_list_ids  = []
              + protocol         = "tcp"
              + security_groups  = []
              + self             = false
              + to_port          = 22
                # (1 unchanged attribute hidden)
            },
        ]
      + name                   = "custom_sg"
      + name_prefix            = (known after apply)
      + owner_id               = (known after apply)
      + revoke_rules_on_delete = false
      + tags                   = {
          + "Name" = "custom_sg"
        }
      + tags_all               = {
          + "Name" = "custom_sg"
        }
      + vpc_id                 = (known after apply)
    }

  # aws_subnet.custom_subnet will be created
  + resource "aws_subnet" "custom_subnet" {
      + arn                                            = (known after apply)
      + assign_ipv6_address_on_creation                = false
      + availability_zone                              = "us-east-1a"
      + availability_zone_id                           = (known after apply)
      + cidr_block                                     = "10.0.1.0/24"
      + enable_dns64                                   = false
      + enable_resource_name_dns_a_record_on_launch    = false
      + enable_resource_name_dns_aaaa_record_on_launch = false
      + id                                             = (known after apply)
      + ipv6_cidr_block_association_id                 = (known after apply)
      + ipv6_native                                    = false
      + map_public_ip_on_launch                        = false
      + owner_id                                       = (known after apply)
      + private_dns_hostname_type_on_launch            = (known after apply)
      + tags                                           = {
          + "Name" = "custom_subnet"
        }
      + tags_all                                       = {
          + "Name" = "custom_subnet"
        }
      + vpc_id                                         = (known after apply)
    }

  # aws_vpc.custom_vpc will be created
  + resource "aws_vpc" "custom_vpc" {
      + arn                                  = (known after apply)
      + cidr_block                           = "10.0.0.0/16"
      + default_network_acl_id               = (known after apply)
      + default_route_table_id               = (known after apply)
      + default_security_group_id            = (known after apply)
      + dhcp_options_id                      = (known after apply)
      + enable_dns_hostnames                 = (known after apply)
      + enable_dns_support                   = true
      + enable_network_address_usage_metrics = (known after apply)
      + id                                   = (known after apply)
      + instance_tenancy                     = "default"
      + ipv6_association_id                  = (known after apply)
      + ipv6_cidr_block                      = (known after apply)
      + ipv6_cidr_block_network_border_group = (known after apply)
      + main_route_table_id                  = (known after apply)
      + owner_id                             = (known after apply)
      + tags                                 = {
          + "Name" = "custom_vpc"
        }
      + tags_all                             = {
          + "Name" = "custom_vpc"
        }
    }

Plan: 4 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + instance_id = (known after apply)

──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

Saved the plan to: tfplan

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan"
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ terraform apply tfplan
aws_vpc.custom_vpc: Creating...
aws_vpc.custom_vpc: Creation complete after 3s [id=vpc-005e5062e3fb6c2d0]
aws_subnet.custom_subnet: Creating...
aws_security_group.custom_sg: Creating...
aws_subnet.custom_subnet: Creation complete after 2s [id=subnet-0f79e651b7514a9ac]
aws_security_group.custom_sg: Creation complete after 4s [id=sg-071c933040282a869]
aws_instance.custom_instance: Creating...
╷
│ Error: creating EC2 Instance: operation error EC2: RunInstances, https response error StatusCode: 400, RequestID: ab6a4dd2-b9d5-4d06-aeb9-cdd3f1f21650, api error InvalidAMIID.NotFound: The image id '[ami-0c55b159cbfafe1f0]' does not exist
│
│   with aws_instance.custom_instance,
│   on main.tf line 49, in resource "aws_instance" "custom_instance":
│   49: resource "aws_instance" "custom_instance" {
│
╵

ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ aws ec2 describe-images --filters "Name=name,Values=ubuntu/images/hvm-ssd/ubuntu-focal-22.04-amd64-server-*" \
"Name=state,Values=available" --query 'Images[*].[ImageId,Name]' --output table --region us-east-1
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ aws ec2 describe-images --filters "Name=name,Values=ubuntu/images/hvm-ssd/ubuntu-focal-22.04-amd64-server-*" "Name=state,Values=available" --query 'Images[*].[ImageId,Name]' --output table --region us-east-1
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ terraform plan -out=tfplan
aws_vpc.custom_vpc: Refreshing state... [id=vpc-005e5062e3fb6c2d0]
aws_subnet.custom_subnet: Refreshing state... [id=subnet-0f79e651b7514a9ac]
aws_security_group.custom_sg: Refreshing state... [id=sg-071c933040282a869]

Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # aws_instance.custom_instance will be created
  + resource "aws_instance" "custom_instance" {
      + ami                                  = "ami-036841078a4b68e14"
      + arn                                  = (known after apply)
      + associate_public_ip_address          = (known after apply)
      + availability_zone                    = (known after apply)
      + cpu_core_count                       = (known after apply)
      + cpu_threads_per_core                 = (known after apply)
      + disable_api_stop                     = (known after apply)
      + disable_api_termination              = (known after apply)
      + ebs_optimized                        = (known after apply)
      + enable_primary_ipv6                  = (known after apply)
      + get_password_data                    = false
      + host_id                              = (known after apply)
      + host_resource_group_arn              = (known after apply)
      + iam_instance_profile                 = (known after apply)
      + id                                   = (known after apply)
      + instance_initiated_shutdown_behavior = (known after apply)
      + instance_lifecycle                   = (known after apply)
      + instance_state                       = (known after apply)
      + instance_type                        = "t3.micro"
      + ipv6_address_count                   = (known after apply)
      + ipv6_addresses                       = (known after apply)
      + key_name                             = (known after apply)
      + monitoring                           = (known after apply)
      + outpost_arn                          = (known after apply)
      + password_data                        = (known after apply)
      + placement_group                      = (known after apply)
      + placement_partition_number           = (known after apply)
      + primary_network_interface_id         = (known after apply)
      + private_dns                          = (known after apply)
      + private_ip                           = (known after apply)
      + public_dns                           = (known after apply)
      + public_ip                            = (known after apply)
      + secondary_private_ips                = (known after apply)
      + security_groups                      = (known after apply)
      + source_dest_check                    = true
      + spot_instance_request_id             = (known after apply)
      + subnet_id                            = "subnet-0f79e651b7514a9ac"
      + tags                                 = {
          + "Name" = "custom_instance"
        }
      + tags_all                             = {
          + "Name" = "custom_instance"
        }
      + tenancy                              = (known after apply)
      + user_data                            = (known after apply)
      + user_data_base64                     = (known after apply)
      + user_data_replace_on_change          = false
      + vpc_security_group_ids               = [
          + "sg-071c933040282a869",
        ]

      + capacity_reservation_specification (known after apply)

      + cpu_options (known after apply)

      + ebs_block_device (known after apply)

      + enclave_options (known after apply)

      + ephemeral_block_device (known after apply)

      + instance_market_options (known after apply)

      + maintenance_options (known after apply)

      + metadata_options (known after apply)

      + network_interface (known after apply)

      + private_dns_name_options (known after apply)

      + root_block_device (known after apply)
    }

Plan: 1 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + instance_id = (known after apply)

──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

Saved the plan to: tfplan

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan"
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ terraform apply tfplan
aws_instance.custom_instance: Creating...
╷
│ Error: creating EC2 Instance: operation error EC2: RunInstances, https response error StatusCode: 400, RequestID: ec9c010b-38c7-445c-9244-af4692dacc38, api error InvalidAMIID.NotFound: The image id '[ami-036841078a4b68e14]' does not exist
│
│   with aws_instance.custom_instance,
│   on main.tf line 49, in resource "aws_instance" "custom_instance":
│   49: resource "aws_instance" "custom_instance" {
│
╵
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ terraform plan -out=tfplan
aws_vpc.custom_vpc: Refreshing state... [id=vpc-005e5062e3fb6c2d0]
aws_subnet.custom_subnet: Refreshing state... [id=subnet-0f79e651b7514a9ac]
aws_security_group.custom_sg: Refreshing state... [id=sg-071c933040282a869]

Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # aws_instance.custom_instance will be created
  + resource "aws_instance" "custom_instance" {
      + ami                                  = "ami-0e2c8caa4b6378d8c"
      + arn                                  = (known after apply)
      + associate_public_ip_address          = (known after apply)
      + availability_zone                    = (known after apply)
      + cpu_core_count                       = (known after apply)
      + cpu_threads_per_core                 = (known after apply)
      + disable_api_stop                     = (known after apply)
      + disable_api_termination              = (known after apply)
      + ebs_optimized                        = (known after apply)
      + enable_primary_ipv6                  = (known after apply)
      + get_password_data                    = false
      + host_id                              = (known after apply)
      + host_resource_group_arn              = (known after apply)
      + iam_instance_profile                 = (known after apply)
      + id                                   = (known after apply)
      + instance_initiated_shutdown_behavior = (known after apply)
      + instance_lifecycle                   = (known after apply)
      + instance_state                       = (known after apply)
      + instance_type                        = "t3.micro"
      + ipv6_address_count                   = (known after apply)
      + ipv6_addresses                       = (known after apply)
      + key_name                             = (known after apply)
      + monitoring                           = (known after apply)
      + outpost_arn                          = (known after apply)
      + password_data                        = (known after apply)
      + placement_group                      = (known after apply)
      + placement_partition_number           = (known after apply)
      + primary_network_interface_id         = (known after apply)
      + private_dns                          = (known after apply)
      + private_ip                           = (known after apply)
      + public_dns                           = (known after apply)
      + public_ip                            = (known after apply)
      + secondary_private_ips                = (known after apply)
      + security_groups                      = (known after apply)
      + source_dest_check                    = true
      + spot_instance_request_id             = (known after apply)
      + subnet_id                            = "subnet-0f79e651b7514a9ac"
      + tags                                 = {
          + "Name" = "custom_instance"
        }
      + tags_all                             = {
          + "Name" = "custom_instance"
        }
      + tenancy                              = (known after apply)
      + user_data                            = (known after apply)
      + user_data_base64                     = (known after apply)
      + user_data_replace_on_change          = false
      + vpc_security_group_ids               = [
          + "sg-071c933040282a869",
        ]

      + capacity_reservation_specification (known after apply)

      + cpu_options (known after apply)

      + ebs_block_device (known after apply)

      + enclave_options (known after apply)

      + ephemeral_block_device (known after apply)

      + instance_market_options (known after apply)

      + maintenance_options (known after apply)

      + metadata_options (known after apply)

      + network_interface (known after apply)

      + private_dns_name_options (known after apply)

      + root_block_device (known after apply)
    }

Plan: 1 to add, 0 to change, 0 to destroy.

Changes to Outputs:
  + instance_id = (known after apply)

──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

Saved the plan to: tfplan

To perform exactly these actions, run the following command to apply:
    terraform apply "tfplan"
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ terraform apply tfplan
aws_instance.custom_instance: Creating...
aws_instance.custom_instance: Still creating... [10s elapsed]
aws_instance.custom_instance: Creation complete after 14s [id=i-0e31db29e9e70d4ee]

Apply complete! Resources: 1 added, 0 changed, 0 destroyed.

Outputs:

instance_id = "i-0e31db29e9e70d4ee"
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ aws ec2 describe-instances --instance-ids i-0e31db29e9e70d4ee \
  --query 'Reservations[*].Instances[*].[InstanceId, State.Name, PrivateIpAddress, PublicIpAddress, Tags]' \
  --output table --region us-east-1

list index out of range
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ aws ec2 describe-security-groups --query 'SecurityGroups[?GroupName==`custom_sg`].GroupId' \
  --output text --region us-east-1
sg-071c933040282a869
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ aws ec2 describe-security-groups --group-ids <SecurityGroupID> \
  --query 'SecurityGroups[*].[GroupId, GroupName, IpPermissions, IpPermissionsEgress]' \
  --output json --region us-east-1
-bash: SecurityGroupID: No such file or directory
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ aws ec2 describe-security-groups --group-ids <SecurityGroupID> \
  --query 'SecurityGroups[*].[GroupId, GroupName, IpPermissions, IpPermissionsEgress]' \
  --output json --region us-east-1
-bash: SecurityGroupID: No such file or directory
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ terraform show
# aws_instance.custom_instance:
resource "aws_instance" "custom_instance" {
    ami                                  = "ami-0e2c8caa4b6378d8c"
    arn                                  = "arn:aws:ec2:us-east-1:443370672158:instance/i-0e31db29e9e70d4ee"
    associate_public_ip_address          = false
    availability_zone                    = "us-east-1a"
    cpu_core_count                       = 1
    cpu_threads_per_core                 = 2
    disable_api_stop                     = false
    disable_api_termination              = false
    ebs_optimized                        = false
    get_password_data                    = false
    hibernation                          = false
    host_id                              = null
    iam_instance_profile                 = null
    id                                   = "i-0e31db29e9e70d4ee"
    instance_initiated_shutdown_behavior = "stop"
    instance_lifecycle                   = null
    instance_state                       = "running"
    instance_type                        = "t3.micro"
    ipv6_address_count                   = 0
    ipv6_addresses                       = []
    key_name                             = null
    monitoring                           = false
    outpost_arn                          = null
    password_data                        = null
    placement_group                      = null
    placement_partition_number           = 0
    primary_network_interface_id         = "eni-063ac88243f8e25b6"
    private_dns                          = "ip-10-0-1-35.ec2.internal"
    private_ip                           = "10.0.1.35"
    public_dns                           = null
    public_ip                            = null
    secondary_private_ips                = []
    security_groups                      = []
    source_dest_check                    = true
    spot_instance_request_id             = null
    subnet_id                            = "subnet-0f79e651b7514a9ac"
    tags                                 = {
        "Name" = "custom_instance"
    }
    tags_all                             = {
        "Name" = "custom_instance"
    }
    tenancy                              = "default"
    user_data_replace_on_change          = false
    vpc_security_group_ids               = [
        "sg-071c933040282a869",
    ]

    capacity_reservation_specification {
        capacity_reservation_preference = "open"
    }

    cpu_options {
        amd_sev_snp      = null
        core_count       = 1
        threads_per_core = 2
    }

    credit_specification {
        cpu_credits = "unlimited"
    }

    enclave_options {
        enabled = false
    }

    maintenance_options {
        auto_recovery = "default"
    }

    metadata_options {
        http_endpoint               = "enabled"
        http_protocol_ipv6          = "disabled"
        http_put_response_hop_limit = 2
        http_tokens                 = "required"
        instance_metadata_tags      = "disabled"
    }

    private_dns_name_options {
        enable_resource_name_dns_a_record    = false
        enable_resource_name_dns_aaaa_record = false
        hostname_type                        = "ip-name"
    }

    root_block_device {
        delete_on_termination = true
        device_name           = "/dev/sda1"
        encrypted             = false
        iops                  = 3000
        kms_key_id            = null
        tags                  = {}
        tags_all              = {}
        throughput            = 125
        volume_id             = "vol-0895429047a130e64"
        volume_size           = 8
        volume_type           = "gp3"
    }
}

# aws_security_group.custom_sg:
resource "aws_security_group" "custom_sg" {
    arn                    = "arn:aws:ec2:us-east-1:443370672158:security-group/sg-071c933040282a869"
    description            = "Custom security group"
    egress                 = [
        {
            cidr_blocks      = [
                "0.0.0.0/0",
            ]
            description      = null
            from_port        = 0
            ipv6_cidr_blocks = []
            prefix_list_ids  = []
            protocol         = "-1"
            security_groups  = []
            self             = false
            to_port          = 0
        },
    ]
    id                     = "sg-071c933040282a869"
    ingress                = [
        {
            cidr_blocks      = [
                "0.0.0.0/0",
            ]
            description      = null
            from_port        = 22
            ipv6_cidr_blocks = []
            prefix_list_ids  = []
            protocol         = "tcp"
            security_groups  = []
            self             = false
            to_port          = 22
        },
    ]
    name                   = "custom_sg"
    name_prefix            = null
    owner_id               = "443370672158"
    revoke_rules_on_delete = false
    tags                   = {
        "Name" = "custom_sg"
    }
    tags_all               = {
        "Name" = "custom_sg"
    }
    vpc_id                 = "vpc-005e5062e3fb6c2d0"
}

# aws_subnet.custom_subnet:
resource "aws_subnet" "custom_subnet" {
    arn                                            = "arn:aws:ec2:us-east-1:443370672158:subnet/subnet-0f79e651b7514a9ac"
    assign_ipv6_address_on_creation                = false
    availability_zone                              = "us-east-1a"
    availability_zone_id                           = "use1-az4"
    cidr_block                                     = "10.0.1.0/24"
    customer_owned_ipv4_pool                       = null
    enable_dns64                                   = false
    enable_lni_at_device_index                     = 0
    enable_resource_name_dns_a_record_on_launch    = false
    enable_resource_name_dns_aaaa_record_on_launch = false
    id                                             = "subnet-0f79e651b7514a9ac"
    ipv6_cidr_block                                = null
    ipv6_cidr_block_association_id                 = null
    ipv6_native                                    = false
    map_customer_owned_ip_on_launch                = false
    map_public_ip_on_launch                        = false
    outpost_arn                                    = null
    owner_id                                       = "443370672158"
    private_dns_hostname_type_on_launch            = "ip-name"
    tags                                           = {
        "Name" = "custom_subnet"
    }
    tags_all                                       = {
        "Name" = "custom_subnet"
    }
    vpc_id                                         = "vpc-005e5062e3fb6c2d0"
}

# aws_vpc.custom_vpc:
resource "aws_vpc" "custom_vpc" {
    arn                                  = "arn:aws:ec2:us-east-1:443370672158:vpc/vpc-005e5062e3fb6c2d0"
    assign_generated_ipv6_cidr_block     = false
    cidr_block                           = "10.0.0.0/16"
    default_network_acl_id               = "acl-0e52cb8d3428e312b"
    default_route_table_id               = "rtb-0912c3806391d6d77"
    default_security_group_id            = "sg-0783076225d8e9d0d"
    dhcp_options_id                      = "dopt-0d6da9b0a87c3cfae"
    enable_dns_hostnames                 = false
    enable_dns_support                   = true
    enable_network_address_usage_metrics = false
    id                                   = "vpc-005e5062e3fb6c2d0"
    instance_tenancy                     = "default"
    ipv6_association_id                  = null
    ipv6_cidr_block                      = null
    ipv6_cidr_block_network_border_group = null
    ipv6_ipam_pool_id                    = null
    ipv6_netmask_length                  = 0
    main_route_table_id                  = "rtb-0912c3806391d6d77"
    owner_id                             = "443370672158"
    tags                                 = {
        "Name" = "custom_vpc"
    }
    tags_all                             = {
        "Name" = "custom_vpc"
    }
}


Outputs:

instance_id = "i-0e31db29e9e70d4ee"
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ aws ec2 describe-security-groups --group-ids sg-071c933040282a869 \
  --query 'SecurityGroups[*].[GroupId, GroupName, IpPermissions, IpPermissionsEgress]' \
  --output json --region us-east-1
[
    [
        "sg-071c933040282a869",
        "custom_sg",
        [
            {
                "IpProtocol": "tcp",
                "FromPort": 22,
                "ToPort": 22,
                "UserIdGroupPairs": [],
                "IpRanges": [
                    {
                        "CidrIp": "0.0.0.0/0"
                    }
                ],
                "Ipv6Ranges": [],
                "PrefixListIds": []
            }
        ],
        [
            {
                "IpProtocol": "-1",
                "UserIdGroupPairs": [],
                "IpRanges": [
                    {
                        "CidrIp": "0.0.0.0/0"
                    }
                ],
                "Ipv6Ranges": [],
                "PrefixListIds": []
            }
        ]
    ]
]
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ aws ec2 describe-instances --instance-ids i-0e31db29e9e70d4ee \
  --query 'Reservations[*].Instances[*].[InstanceId, State.Name, PrivateIpAddress, Tags]' \
  --output table --region us-east-1

list index out of range
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ aws ec2 describe-instances \
  --filters "Name=instance-state-name,Values=running" \
  --query 'Reservations[*].Instances[*].[InstanceId, State.Name, PrivateIpAddress, Tags]' \
  --output table --region us-east-1

list index out of range
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ aws ec2 describe-instances \
  --query 'Reservations[*].Instances[*].[InstanceId, State.Name, PrivateIpAddress, Tags]' \
  --output table --region us-east-1

list index out of range
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ terraform state list
aws_instance.custom_instance
aws_security_group.custom_sg
aws_subnet.custom_subnet
aws_vpc.custom_vpc
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ aws ec2 describe-instances --instance-ids i-0e31db29e9e70d4ee \
  --query 'Reservations[*].Instances[*].[InstanceId, State.Name, PrivateIpAddress]' \
  --output table --region us-east-1
-------------------------------------------------
|               DescribeInstances               |
+----------------------+----------+-------------+
|  i-0e31db29e9e70d4ee |  running |  10.0.1.35  |
+----------------------+----------+-------------+
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ aws ec2 describe-instances --instance-ids i-0e31db29e9e70d4ee \
  --query 'Reservations[*].Instances[*].[InstanceId, State.Name, PrivateIpAddress, Tags[?Key==`Name`].Value | [0]]' \
  --output table --region us-east-1
--------------------------------------------------------------------
|                         DescribeInstances                        |
+----------------------+----------+------------+-------------------+
|  i-0e31db29e9e70d4ee |  running |  10.0.1.35 |  custom_instance  |
+----------------------+----------+------------+-------------------+
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ aws ec2 describe-instances --region us-east-1 --output json
{
    "Reservations": [
        {
            "ReservationId": "r-0413a608af947cdd9",
            "OwnerId": "443370672158",
            "Groups": [],
            "Instances": [
                {
                    "Architecture": "x86_64",
                    "BlockDeviceMappings": [
                        {
                            "DeviceName": "/dev/sda1",
                            "Ebs": {
                                "AttachTime": "2024-12-17T16:08:36+00:00",
                                "DeleteOnTermination": true,
                                "Status": "attached",
                                "VolumeId": "vol-068e6f4d5a33c5d10"
                            }
                        }
                    ],
                    "ClientToken": "e358442a-4847-424b-9ac2-af97a572a304",
                    "EbsOptimized": false,
                    "EnaSupport": true,
                    "Hypervisor": "xen",
                    "NetworkInterfaces": [
                        {
                            "Attachment": {
                                "AttachTime": "2024-12-17T16:08:36+00:00",
                                "AttachmentId": "eni-attach-072b50f127e9b1df3",
                                "DeleteOnTermination": true,
                                "DeviceIndex": 0,
                                "Status": "attached",
                                "NetworkCardIndex": 0
                            },
                            "Description": "",
                            "Groups": [
                                {
                                    "GroupId": "sg-08348b66db7230fb9",
                                    "GroupName": "launch-wizard-1"
                                }
                            ],
                            "Ipv6Addresses": [],
                            "MacAddress": "12:a7:ed:d4:0e:b7",
                            "NetworkInterfaceId": "eni-03286702913b2ca2a",
                            "OwnerId": "443370672158",
                            "PrivateDnsName": "ip-172-31-83-91.ec2.internal",
                            "PrivateIpAddress": "172.31.83.91",
                            "PrivateIpAddresses": [
                                {
                                    "Primary": true,
                                    "PrivateDnsName": "ip-172-31-83-91.ec2.internal",
                                    "PrivateIpAddress": "172.31.83.91"
                                }
                            ],
                            "SourceDestCheck": true,
                            "Status": "in-use",
                            "SubnetId": "subnet-051774fda132251b3",
                            "VpcId": "vpc-0ba16865d0655a924",
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$

ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ terraform destroy
aws_vpc.custom_vpc: Refreshing state... [id=vpc-005e5062e3fb6c2d0]
aws_subnet.custom_subnet: Refreshing state... [id=subnet-0f79e651b7514a9ac]
aws_security_group.custom_sg: Refreshing state... [id=sg-071c933040282a869]
aws_instance.custom_instance: Refreshing state... [id=i-0e31db29e9e70d4ee]

Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
  - destroy

Terraform will perform the following actions:

  # aws_instance.custom_instance will be destroyed
  - resource "aws_instance" "custom_instance" {
      - ami                                  = "ami-0e2c8caa4b6378d8c" -> null
      - arn                                  = "arn:aws:ec2:us-east-1:443370672158:instance/i-0e31db29e9e70d4ee" -> null
      - associate_public_ip_address          = false -> null
      - availability_zone                    = "us-east-1a" -> null
      - cpu_core_count                       = 1 -> null
      - cpu_threads_per_core                 = 2 -> null
      - disable_api_stop                     = false -> null
      - disable_api_termination              = false -> null
      - ebs_optimized                        = false -> null
      - get_password_data                    = false -> null
      - hibernation                          = false -> null
      - id                                   = "i-0e31db29e9e70d4ee" -> null
      - instance_initiated_shutdown_behavior = "stop" -> null
      - instance_state                       = "running" -> null
      - instance_type                        = "t3.micro" -> null
      - ipv6_address_count                   = 0 -> null
      - ipv6_addresses                       = [] -> null
      - monitoring                           = false -> null
      - placement_partition_number           = 0 -> null
      - primary_network_interface_id         = "eni-063ac88243f8e25b6" -> null
      - private_dns                          = "ip-10-0-1-35.ec2.internal" -> null
      - private_ip                           = "10.0.1.35" -> null
      - secondary_private_ips                = [] -> null
      - security_groups                      = [] -> null
      - source_dest_check                    = true -> null
      - subnet_id                            = "subnet-0f79e651b7514a9ac" -> null
      - tags                                 = {
          - "Name" = "custom_instance"
        } -> null
      - tags_all                             = {
          - "Name" = "custom_instance"
        } -> null
      - tenancy                              = "default" -> null
      - user_data_replace_on_change          = false -> null
      - vpc_security_group_ids               = [
          - "sg-071c933040282a869",
        ] -> null
        # (10 unchanged attributes hidden)

      - capacity_reservation_specification {
          - capacity_reservation_preference = "open" -> null
        }

      - cpu_options {
          - core_count       = 1 -> null
          - threads_per_core = 2 -> null
            # (1 unchanged attribute hidden)
        }

      - credit_specification {
          - cpu_credits = "unlimited" -> null
        }

      - enclave_options {
          - enabled = false -> null
        }

      - maintenance_options {
          - auto_recovery = "default" -> null
        }

      - metadata_options {
          - http_endpoint               = "enabled" -> null
          - http_protocol_ipv6          = "disabled" -> null
          - http_put_response_hop_limit = 2 -> null
          - http_tokens                 = "required" -> null
          - instance_metadata_tags      = "disabled" -> null
        }

      - private_dns_name_options {
          - enable_resource_name_dns_a_record    = false -> null
          - enable_resource_name_dns_aaaa_record = false -> null
          - hostname_type                        = "ip-name" -> null
        }

      - root_block_device {
          - delete_on_termination = true -> null
          - device_name           = "/dev/sda1" -> null
          - encrypted             = false -> null
          - iops                  = 3000 -> null
          - tags                  = {} -> null
          - tags_all              = {} -> null
          - throughput            = 125 -> null
          - volume_id             = "vol-0895429047a130e64" -> null
          - volume_size           = 8 -> null
          - volume_type           = "gp3" -> null
            # (1 unchanged attribute hidden)
        }
    }

  # aws_security_group.custom_sg will be destroyed
  - resource "aws_security_group" "custom_sg" {
      - arn                    = "arn:aws:ec2:us-east-1:443370672158:security-group/sg-071c933040282a869" -> null
      - description            = "Custom security group" -> null
      - egress                 = [
          - {
              - cidr_blocks      = [
                  - "0.0.0.0/0",
                ]
              - from_port        = 0
              - ipv6_cidr_blocks = []
              - prefix_list_ids  = []
              - protocol         = "-1"
              - security_groups  = []
              - self             = false
              - to_port          = 0
                # (1 unchanged attribute hidden)
            },
        ] -> null
      - id                     = "sg-071c933040282a869" -> null
      - ingress                = [
          - {
              - cidr_blocks      = [
                  - "0.0.0.0/0",
                ]
              - from_port        = 22
              - ipv6_cidr_blocks = []
              - prefix_list_ids  = []
              - protocol         = "tcp"
              - security_groups  = []
              - self             = false
              - to_port          = 22
                # (1 unchanged attribute hidden)
            },
        ] -> null
      - name                   = "custom_sg" -> null
      - owner_id               = "443370672158" -> null
      - revoke_rules_on_delete = false -> null
      - tags                   = {
          - "Name" = "custom_sg"
        } -> null
      - tags_all               = {
          - "Name" = "custom_sg"
        } -> null
      - vpc_id                 = "vpc-005e5062e3fb6c2d0" -> null
        # (1 unchanged attribute hidden)
    }

  # aws_subnet.custom_subnet will be destroyed
  - resource "aws_subnet" "custom_subnet" {
      - arn                                            = "arn:aws:ec2:us-east-1:443370672158:subnet/subnet-0f79e651b7514a9ac" -> null
      - assign_ipv6_address_on_creation                = false -> null
      - availability_zone                              = "us-east-1a" -> null
      - availability_zone_id                           = "use1-az4" -> null
      - cidr_block                                     = "10.0.1.0/24" -> null
      - enable_dns64                                   = false -> null
      - enable_lni_at_device_index                     = 0 -> null
      - enable_resource_name_dns_a_record_on_launch    = false -> null
      - enable_resource_name_dns_aaaa_record_on_launch = false -> null
      - id                                             = "subnet-0f79e651b7514a9ac" -> null
      - ipv6_native                                    = false -> null
      - map_customer_owned_ip_on_launch                = false -> null
      - map_public_ip_on_launch                        = false -> null
      - owner_id                                       = "443370672158" -> null
      - private_dns_hostname_type_on_launch            = "ip-name" -> null
      - tags                                           = {
          - "Name" = "custom_subnet"
        } -> null
      - tags_all                                       = {
          - "Name" = "custom_subnet"
        } -> null
      - vpc_id                                         = "vpc-005e5062e3fb6c2d0" -> null
        # (4 unchanged attributes hidden)
    }

  # aws_vpc.custom_vpc will be destroyed
  - resource "aws_vpc" "custom_vpc" {
      - arn                                  = "arn:aws:ec2:us-east-1:443370672158:vpc/vpc-005e5062e3fb6c2d0" -> null
      - assign_generated_ipv6_cidr_block     = false -> null
      - cidr_block                           = "10.0.0.0/16" -> null
      - default_network_acl_id               = "acl-0e52cb8d3428e312b" -> null
      - default_route_table_id               = "rtb-0912c3806391d6d77" -> null
      - default_security_group_id            = "sg-0783076225d8e9d0d" -> null
      - dhcp_options_id                      = "dopt-0d6da9b0a87c3cfae" -> null
      - enable_dns_hostnames                 = false -> null
      - enable_dns_support                   = true -> null
      - enable_network_address_usage_metrics = false -> null
      - id                                   = "vpc-005e5062e3fb6c2d0" -> null
      - instance_tenancy                     = "default" -> null
      - ipv6_netmask_length                  = 0 -> null
      - main_route_table_id                  = "rtb-0912c3806391d6d77" -> null
      - owner_id                             = "443370672158" -> null
      - tags                                 = {
          - "Name" = "custom_vpc"
        } -> null
      - tags_all                             = {
          - "Name" = "custom_vpc"
        } -> null
        # (4 unchanged attributes hidden)
    }

Plan: 0 to add, 0 to change, 4 to destroy.

Changes to Outputs:
  - instance_id = "i-0e31db29e9e70d4ee" -> null

Do you really want to destroy all resources?
  Terraform will destroy all your managed infrastructure, as shown above.
  There is no undo. Only 'yes' will be accepted to confirm.

  Enter a value: yes

aws_instance.custom_instance: Destroying... [id=i-0e31db29e9e70d4ee]
aws_instance.custom_instance: Still destroying... [id=i-0e31db29e9e70d4ee, 10s elapsed]
aws_instance.custom_instance: Still destroying... [id=i-0e31db29e9e70d4ee, 20s elapsed]
aws_instance.custom_instance: Still destroying... [id=i-0e31db29e9e70d4ee, 30s elapsed]
aws_instance.custom_instance: Destruction complete after 31s
aws_subnet.custom_subnet: Destroying... [id=subnet-0f79e651b7514a9ac]
aws_security_group.custom_sg: Destroying... [id=sg-071c933040282a869]
aws_subnet.custom_subnet: Destruction complete after 1s
aws_security_group.custom_sg: Destruction complete after 1s
aws_vpc.custom_vpc: Destroying... [id=vpc-005e5062e3fb6c2d0]
aws_vpc.custom_vpc: Destruction complete after 1s

Destroy complete! Resources: 4 destroyed.
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$ aws ec2 describe-instances --instance-ids i-0e31db29e9e70d4ee \
  --query 'Reservations[*].Instances[*].[InstanceId, State.Name, PrivateIpAddress, Tags[?Key==`Name`].Value | [0]]' \
  --output table --region us-east-1
------------------------------------------------------------------
|                        DescribeInstances                       |
+----------------------+-------------+-------+-------------------+
|  i-0e31db29e9e70d4ee |  terminated |  None |  custom_instance  |
+----------------------+-------------+-------+-------------------+
ivcpaladin@ivcpaladin:~/01.HW_automation/terraform-aws-setup$


```



###
